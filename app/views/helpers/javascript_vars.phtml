<?php
$mark = RSSServer_Context::$user_conf->mark_when;
$s = validateShortcutList(RSSServer_Context::$user_conf->shortcuts);
echo htmlspecialchars(json_encode(array(
	'context' => array(
		'anonymous' => !RSSServer_Auth::hasAccess(),
		'auto_remove_article' => !!RSSServer_Context::isAutoRemoveAvailable(),
		'hide_posts' => !(RSSServer_Context::$user_conf->display_posts || Minz_Request::actionName() === 'reader'),
		'display_order' => Minz_Request::param('order', RSSServer_Context::$user_conf->sort_order),
		'auto_mark_article' => !!$mark['article'],
		'auto_mark_site' => !!$mark['site'],
		'auto_mark_scroll' => !!$mark['scroll'],
		'auto_load_more' => !!RSSServer_Context::$user_conf->auto_load_more,
		'auto_actualize_feeds' => !!Minz_Session::param('actualize_feeds', false),
		'does_lazyload' => !!RSSServer_Context::$user_conf->lazyload ,
		'sides_close_article' => !!RSSServer_Context::$user_conf->sides_close_article,
		'sticky_post' => !!RSSServer_Context::isStickyPostEnabled(),
		'html5_notif_timeout' => RSSServer_Context::$user_conf->html5_notif_timeout,
		'auth_type' => RSSServer_Context::$system_conf->auth_type,
		'current_view' => Minz_Request::actionName(),
		'csrf' => RSSServer_Auth::csrfToken(),
	),
	'shortcuts' => array(
		'mark_read' => @$s['mark_read'],
		'mark_favorite' => @$s['mark_favorite'],
		'go_website' => @$s['go_website'],
		'prev_entry' => @$s['prev_entry'],
		'next_entry' => @$s['next_entry'],
		'skip_prev_entry' => @$s['skip_prev_entry'],
		'skip_next_entry' => @$s['skip_next_entry'],
		'first_entry' => @$s['first_entry'],
		'last_entry' => @$s['last_entry'],
		'collapse_entry' => @$s['collapse_entry'],
		'load_more' => @$s['load_more'],
		'auto_share' => @$s['auto_share'],
		'focus_search' => @$s['focus_search'],
		'user_filter' => @$s['user_filter'],
		'help' => @$s['help'],
		'close_dropdown' => @$s['close_dropdown'],
		'normal_view' => @$s['normal_view'],
		'global_view' => @$s['global_view'],
		'reading_view' => @$s['reading_view'],
		'rss_view' => @$s['rss_view'],
	),
	'urls' => array(
		'index' => _url('index', 'index'),
		'login' => Minz_Url::display(array('c' => 'auth', 'a' => 'login'), 'php'),
		'logout' => Minz_Url::display(array('c' => 'auth', 'a' => 'logout'), 'php'),
		'help' => RSSSERVER_WIKI,
	),
	'i18n' => array(
		'confirmation_default' => _t('gen.js.confirm_action'),
		'notif_title_articles' => _t('gen.js.feedback.title_new_articles'),
		'notif_body_articles' => _t('gen.js.feedback.body_new_articles'),
		'notif_request_failed' => _t('gen.js.feedback.request_failed'),
		'category_empty' => _t('gen.js.category_empty'),
	),
	'icons' => array(
		'read' => rawurlencode(_i('read')),
		'unread' => rawurlencode(_i('unread')),
	),
), JSON_UNESCAPED_UNICODE), ENT_NOQUOTES, 'UTF-8');
